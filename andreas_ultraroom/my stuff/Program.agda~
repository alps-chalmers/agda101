module Program where
{-program representation in Agda-}

{-imported modules-}
--open import Nat
open import Bool
open import Lists
open import Data.Nat

{-variable for natural numbers-}
data NVar : Set where
  vN : (i : ℕ) -> NVar {-each nat-var represented by a natural number-}

{-variable for booleans-}
data BVar : Set where
  vB : (i : ℕ) -> BVar {-each bool-var represented by a natural number-}

{-expressions for natural numbers-}
data ExpN : Set where
  nat : ℕ -> ExpN
  nVar : NVar -> ExpN

{-expressions for booleans-}
data ExpB : Set where
  --bool : Bool -> BVar -> ExpB
  bool : Bool -> ExpB
  bVar : BVar -> ExpB

{-general expressions, kind of a 'wrapper' for for the other expressions-}
data Exp : Set where
  expN : ExpN -> Exp
  expB : ExpB -> Exp
  _<?_ _<=?_ _>?_ _>=?_ : ExpN -> ExpN -> Exp
  _==n_ : ExpN -> ExpN -> Exp
  _==b_ : ExpB -> ExpB -> Exp
{-statements, different assignment constructors for bools and nats-}
data Stm : Set where
  <_>:=n<_> : NVar -> ExpN -> Stm
  <_:=n_> : NVar -> ExpN -> Stm
  <_>:=b<_> : BVar -> ExpB -> Stm
  <_:=b_> : BVar -> ExpB -> Stm
  wait : Exp -> Stm

{-labels, to label segments of codes-}
data Label : Set where
  s : ℕ -> Label

{-different constuctors for different segments-}
data Seg : Set where
  seg : Label -> Stm -> Seg
  block : List Seg -> Seg
  par : Label -> List Seg -> Seg
  while if : Label -> ExpB -> Seg -> Seg
  false : Seg

{-
{-record for a program-}
record Prog : Set where
  constructor prog
  field
    init : Seg
    main : Seg
-}

data Prog : Set where
  prog : Seg -> Prog


progList : Prog -> List Seg
progList (prog (block (segs))) = segs
progList _ = false :: empty

--compLabel
